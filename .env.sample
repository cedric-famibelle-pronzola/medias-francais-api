# Source des données TSV
GH_SOURCE=https://raw.githubusercontent.com/cedric-famibelle-pronzola/Medias_francais/refs/heads/master

# Configuration du serveur
API_PORT=8000
API_BASE_PATH=/

# Environnement 
ENVIRONMENT=development

# Cache
CACHE_TTL=300000

# Admin
ADMIN_KEY=my-strong-admin-key

# CORS
CORS_ALLOWED_ORIGINS=mon-domaine.fr,autre-domaine.fr

# Logs
USE_STRUCTURED_LOGGER=false

# Log storage backend (auto, duckdb, postgres)
# auto = détection automatique (postgres si DATABASE_URL existe, sinon duckdb)
LOG_STORAGE_BACKEND=auto

# PostgreSQL connection (requis si LOG_STORAGE_BACKEND=postgres)
# DATABASE_URL=postgresql://user:password@host:5432/database

# === IP Blocking Configuration ===

# IP blocking storage backend (auto, duckdb, postgres, memory)
# auto = détection automatique (postgres si IP_BLOCKING_DATABASE_URL existe, sinon duckdb)
# duckdb = stockage dans un fichier local (logs/ip_blocking.db)
# postgres = stockage dans PostgreSQL (nécessite IP_BLOCKING_DATABASE_URL)
# memory = stockage en mémoire (développement/tests uniquement, données perdues au redémarrage)
IP_BLOCKING_STORAGE=auto

# PostgreSQL connection pour le système de blocage d'IP (optionnel)
# Si non définie, utilise DATABASE_URL comme fallback
# Permet d'utiliser une base de données séparée pour le système de blocage
# IP_BLOCKING_DATABASE_URL=postgresql://user:password@host:5432/ip_blocking_db

# Whitelist d'IPs qui ne peuvent jamais être bloquées (format CSV)
# Ces IPs sont chargées automatiquement au démarrage de l'application
# Exemple: 127.0.0.1,::1,192.168.1.100
IP_BLOCKING_WHITELIST=127.0.0.1,::1

# Stratégie en cas d'erreur de base de données
# false (défaut) = fail-open (autoriser les requêtes si DB indisponible)
# true = fail-closed (bloquer les requêtes si DB indisponible)
IP_BLOCKING_FAIL_CLOSED=false

# === Auto-blocking depuis le rate-limiter ===

# Activer le blocage automatique des IPs qui violent répétitivement le rate-limit
AUTO_BLOCK_ENABLED=false

# Nombre de violations du rate-limit avant auto-blocage
AUTO_BLOCK_THRESHOLD=10

# Durée du blocage automatique en minutes
AUTO_BLOCK_DURATION=60
